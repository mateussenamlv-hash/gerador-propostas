<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Propostas recentes</title>
  <link rel="stylesheet" href="/static/styles.css">
  <style>
    /* extras só dessa tela */
    .list{
      margin-top: 14px;
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 14px;
    }
    @media (max-width: 860px){ .list{ grid-template-columns: 1fr; } }

    .meta{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top: 10px;
    }
    .pill{
      font-size: 12px; color: rgba(255,255,255,.78);
      padding: 8px 10px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.28);
      white-space:nowrap;
    }
    .small{
      margin-top: 8px;
      color: rgba(255,255,255,.58);
      font-size: 12px;
      line-height: 1.45;
    }
    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top: 12px;
    }
    .btn-ghost{
      background: rgba(255,255,255,.04);
      border-color: rgba(255,255,255,.16);
      min-width: 190px;
    }
    .empty{
      margin-top: 14px;
      padding: 18px;
      border-radius: var(--radius);
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      color: rgba(255,255,255,.70);
    }
  </style>
</head>
<body>
  <div class="bg-grid"></div>

  <header class="topbar">
    <div class="topbar-inner">
      <a class="logo" href="/"><img src="/static/logo.png" alt="Logo"></a>
      <nav class="nav">
        <a href="/proposta">Proposta</a>
        <a href="/contrato">Contrato</a>
        <a href="/propostas-recentes">Propostas recentes</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <div class="page-title">
      <h1>Propostas recentes</h1>
      <a class="backlink" href="/">← Voltar</a>
    </div>

    <div class="headline" style="margin-bottom:14px;">
      <h1 style="font-size:22px; margin:0;">15 dias de histórico</h1>
      <p style="margin:8px 0 0;">
        Aqui ficam suas propostas salvas por 15 dias.  
        Clique em <b>Gerar contrato</b> para abrir o contrato já preenchido com o que der.
      </p>
    </div>

    {% if propostas and propostas|length > 0 %}
      <section class="list">
        {% for p in propostas %}
          <article class="card card-hover">
            <div class="card-top">
              <div class="title">
                <div class="icon">
                  <svg viewBox="0 0 24 24" fill="none">
                    <path d="M7 3h7l3 3v15a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1Z" stroke="rgba(255,255,255,.85)" stroke-width="1.6"/>
                    <path d="M14 3v4h4" stroke="rgba(255,255,255,.85)" stroke-width="1.6"/>
                  </svg>
                </div>
                <div>
                  <h2 style="margin:0;">{{ p.cliente or "Cliente" }}</h2>
                  <div class="small">Criada em: {{ p.criada_em or "-" }}</div>
                </div>
              </div>
              <div class="chip">Proposta</div>
            </div>

            <div class="meta">
              {% if p.cpf %}<span class="pill">CPF: {{ p.cpf }}</span>{% endif %}
              {% if p.modelo %}<span class="pill">Modelo: {{ p.modelo }}</span>{% endif %}
              {% if p.franquia %}<span class="pill">Franquia: {{ p.franquia }}</span>{% endif %}
              {% if p.valor %}<span class="pill">Valor: {{ p.valor }}</span>{% endif %}
              {% if p.validade %}<span class="pill">Validade: {{ p.validade }}</span>{% endif %}
            </div>

            <div class="row">
              <!-- abre o contrato com dados reaproveitados -->
              <a class="btn btn-primary" href="/contrato?from={{ p.id }}">GERAR CONTRATO</a>

              <!-- opcional: gerar de novo a proposta PDF (se você já tiver rota) -->
              <a class="btn btn-ghost" href="/proposta?from={{ p.id }}">ABRIR PROPOSTA</a>
            </div>
          </article>
        {% endfor %}
      </section>
    {% else %}
      <div class="empty">
        Nenhuma proposta salva ainda. Crie uma proposta e ela vai aparecer aqui por 15 dias.
      </div>
    {% endif %}
  </main>
</body>
</html>
